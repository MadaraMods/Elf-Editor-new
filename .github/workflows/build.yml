name: Debug APK Build
on: [push, workflow_dispatch]

jobs:
  debug-build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: List project files
      run: |
        echo "=== PROJE DOSYALARI ==="
        ls -la
        echo "=== GRADLE DOSYASI VAR MI? ==="
        ls -la | grep gradle
        echo "=== ANDROID DİZİNİ ==="
        find . -name "android" -type d
      
    - name: Analyze project structure
      run: |
        echo "=== BUILD.GRADLE İÇERİĞİ ==="
        if [ -f "app/build.gradle" ]; then
          cat app/build.gradle | head -20
        elif [ -f "build.gradle" ]; then
          cat build.gradle | head -20
        else
          echo "BUILD.GRADLE BULUNAMADI!"
        fi
        
    - name: Try Java 17 with full log
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        
    - name: Build with debug info
      run: |
        chmod +x ./gradlew
        ./gradlew tasks --all || echo "Gradle tasks failed"
        ./gradlew build --stacktrace --info || echo "Build failed"